<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Image Audio Game</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            text-align: center;
            background: rgba(255, 255, 255, 0.8);
        }

        #background-video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
        }

        #controls {
            margin: 20px;
            font-size: 48px;     /*26*/
        }

        #game-board {
            display: grid;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .card {
            width: 225px;
            height: 225px;
            position: relative;
            border: 2px solid #333;
            border-radius: 10px;
            cursor: pointer;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }

        .background-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: 0;
            transition: opacity 0.3s;
        }

        .card-text {
            position: relative;
            z-index: 1;
            font-size: 50px;
font-family: Verdana;
          //  font-weight: bold;
            color: blue;
            text-shadow: 1px 1px 3px black;
            pointer-events: none;
            margin-bottom: 10px;
        }

        button, input[type="range"], select {
            margin: 5px;
            padding: 6px 12px;
            font-size: 48px; 
        }



        label {
            margin-left: 10px;
        }
    </style>
</head>
<body>

<video id="background-video" autoplay muted loop>
  <source src="../rain.mp4" type="video/mp4">
</video>

<audio id="background-music" src="../song1.mp3" loop></audio>
<audio id="clap-sound" src="../clap.wav"></audio>
<audio id="prompt-sound"></audio>

<div id="controls">
    <button id="start-btn">Start Game</button><br>
    <button id="repeat-btn" disabled>Repeat</button><br>
    <label>Music Volume:
        <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.1" />
    </label><br>
    <label>Image Opacity:
        <input type="range" id="opacity-slider" min="0" max="1" step="0.01" value="0.5" />
    </label><br>
  
    <select id="card-count">
        <option value="3" selected>3 images</option>
        <option value="6">6 images</option>
        <option value="9" >9 images</option>
    </select>
</div>

<div id="game-board"></div>

<script>
    const images = [
        { img: '1.png', audio: '11.mp3', text: 'woman' },
        { img: '2.png', audio: '12.mp3', text: 'man' },
        { img: '3.png', audio: '13.mp3', text: 'dog' },
        { img: '4.png', audio: '14.mp3', text: 'flower' },
        { img: '5.png', audio: '15.mp3', text: 'bird' },
        { img: '6.png', audio: '16.mp3', text: 'baby' },
        { img: '7.png', audio: '17.mp3', text: 'ball' },
        { img: '8.png', audio: '18.mp3', text: 'face' },
        { img: '9.png', audio: '19.mp3', text: 'cat' }
    ];

    const gameBoard = document.getElementById('game-board');
    const startBtn = document.getElementById('start-btn');
    const repeatBtn = document.getElementById('repeat-btn');
    const volumeSlider = document.getElementById('volume-slider');
    const opacitySlider = document.getElementById('opacity-slider');
    const promptSound = document.getElementById('prompt-sound');
    const clapSound = document.getElementById('clap-sound');
    const backgroundMusic = document.getElementById('background-music');
    const cardCountSelect = document.getElementById('card-count');

    let currentTarget = null;
    let currentCards = [];

    function shuffleArray(arr) {
        return [...arr].sort(() => Math.random() - 0.5);
    }

    function createBoard(count) {
        gameBoard.innerHTML = '';
        currentCards = shuffleArray(images).slice(0, count);
        gameBoard.style.gridTemplateColumns = `repeat(3, 225px)`;

        currentCards.forEach(item => {
            const card = document.createElement('div');
            card.className = 'card';

            const bg = document.createElement('div');
            bg.className = 'background-layer';
            bg.style.backgroundImage = `url(${item.img})`;
            bg.style.opacity = opacitySlider.value;

            const text = document.createElement('div');
            text.className = 'card-text';
            text.textContent = item.text;

            card.appendChild(bg);
            card.appendChild(text);

            card.onclick = () => {
                if (item.text === currentTarget.text) {
                    clapSound.play();
                    setTimeout(promptNextTarget, 7000);
                }
            };

            gameBoard.appendChild(card);
        });
    }

    function promptNextTarget() {
        currentTarget = currentCards[Math.floor(Math.random() * currentCards.length)];
        promptSound.src = currentTarget.audio;
        promptSound.play();
    }

    function startGame() {
        const count = parseInt(cardCountSelect.value);
        createBoard(count);
        promptNextTarget();
        repeatBtn.disabled = false;

        // Play music after user interaction
        backgroundMusic.volume = parseFloat(volumeSlider.value);
        backgroundMusic.play().catch(err => {
            console.warn("Background music failed to play:", err);
        });
    }

    startBtn.onclick = startGame;

    repeatBtn.onclick = () => {
        if (currentTarget) {
            promptSound.src = currentTarget.audio;
            promptSound.play();
        }
    };

    volumeSlider.oninput = () => {
        const volume = parseFloat(volumeSlider.value);
        backgroundMusic.volume = volume;
    };

    opacitySlider.oninput = () => {
        document.querySelectorAll('.background-layer').forEach(layer => {
            layer.style.opacity = opacitySlider.value;
        });
    };
</script>

</body>
</html>
